!function(l){var r=void 0,p=void 0,u="https://widget.hippochat.io/widget-agent/",f="https://chat.hippochat.io/widget-scripts/";isComplete=!1;var g,m,h="",C="",v="",y={appSecretKey:"kenwfdhwoiujGSDIUUHU82E8HD98",collapseType:"hide",showData:!1,address:{city:"Chandigarh",country:"India"},customAttributes:{}};function a(e){"function"==typeof e.callback&&(h=e.callback,e.callback=""),"function"==typeof e.collapseCallback&&(C=e.collapseCallback,e.collapseCallback=""),y=e,v=""}function o(e,t){try{"complete"===document.readyState?(e&&0<Object.keys(e).length&&a(e),e.customWhitelabelPointing&&(u=l.location.origin+"/widget-agent",f=l.location.origin+"/widget-scripts/"),function(e){if(r)return"function"==typeof h?(h.call(this),h=""):e.collapseType&&"hide"==e.collapseType&&(b.Expand({type:"Expand",data:{}},u),b.Expand({type:"Expand",data:{}},l.location.origin));var t=document.createElement("iframe");t.id="iframe_fuguAgentWidgetContent",t.setAttribute("allow","microphone; camera"),e.collapseType&&"hide"==e.collapseType&&(t.dataset.collapsedHidden="true");t.src=u,t.style.borderRadius="6px",t.border=0,t.classList.add("collapsed"),document.body.appendChild(t),r=t}(e),n()):document.onreadystatechange=function(){"complete"===document.readyState&&o(e,t)}}catch(e){console.error("Widget exception: ",e)}void 0!==t&&1!=t||(m=e)}function e(e){b.InitHippoLanguage({data:e,origin:u},u)}function n(){r.addEventListener("load",E.load,!1),l.addEventListener("message",E.message,!1)}function i(e,t){try{"complete"===document.readyState?(e&&0<Object.keys(e).length&&a(e),e.customWhitelabelPointing&&(u=l.location.origin+"/widget-agent",f=l.location.origin+"/widget-scripts/"),function(e){(document.getElementById("iframe_fuguWidgetContent")||document.getElementById("iframe_fuguWidget"))&&l.fuguDestroyCustomerWidget();if(r)return"function"==typeof h?(h.call(this),h=""):e.collapseType&&"hide"==e.collapseType&&(b.Expand({type:"Expand",data:{}},u),b.Expand({type:"Expand",data:{}},l.location.origin));var t=document.createElement("iframe");t.id="iframe_fuguAgentWidgetContent",t.classList.add("collapsed"),e.collapseType&&"hide"==e.collapseType&&(t.dataset.collapsedHidden="true");t.src=u,t.style.borderRadius="6px",t.border=0,document.body.appendChild(t),r=t}(e),n()):document.onreadystatechange=function(){"complete"===document.readyState&&i(e,t)}}catch(e){console.error("Widget exception: ",e)}void 0!==t&&1!=t||(m=e)}var t,c,d,s,E={load:function(e){var t;console.log("loaded iframe",e),(t=document.getElementById("iframe_fuguAgentWidgetContent")).style.right=0,t.style.bottom=0,b.Initialize(y,u),function(e){var t=["<link rel='stylesheet' href='"+f+"/public/build/css/circularIframe.css' />"],a="<head>"+["<script async defer src='"+f+"/public/js/circularIframe.js' type='text/javascript'><\/script>"].join("")+t.join("")+"</head><body class='collapsed'></body>",o=document.createElement("iframe");o.id="iframe_agent_fuguWidget",o.classList.add("collapsed"),document.body.appendChild(o);try{o.contentWindow.document.open(),o.contentWindow.document.write(a),o.contentWindow.document.close()}catch(e){console.log(e)}(p=o).style.width="0px",p.style.height="0px",p.style.position="fixed",p.style.left="-500px",p.style.top="-500px",e.collapseType&&"hide"==e.collapseType&&(o.dataset.collapsedHidden="true")}(y)},message:function(e){if("NonCircularAgentIframe"==e.data.message_sender)switch(console.log("non circular iframe message",e),e.data.type){case"Collapse":r.classList.add("collapsed");try{p.classList.add("collapsed"),p.classList.remove("notification-1")}catch(e){console.log(e)}r.classList.remove("notification-1"),b.Collapse({type:"Collapse",data:e.data},l.location.origin),(t=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&(r.classList.remove("ios-fix"),O()),"function"==typeof C&&C.call(this);break;case"Expand":r.classList.remove("collapsed","notification-1");try{p.classList.remove("collapsed","notification-1")}catch(e){console.log(e)}b.Expand(e.data,l.location.origin),(t=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&L();break;case"Config":b.Config(e.data,u);break;case"Notification":r.classList.add("notification-1");try{p.classList.add("notification-1")}catch(e){console.log(e)}b.Notification(e.data,u);break;case"Shutdown":r.classList.add("collapsed");try{p.classList.add("collapsed")}catch(e){console.log(e)}b.Collapse({type:"Collapse",data:e.data},l.location.origin),w(),m&&"hide"!=m.collapseType&&!m.hideWidget&&console.log("_initData: ",m);break;case"SetupComplete":isComplete=!0,"function"==typeof h?(h.call(this),h=""):y.collapseType&&"hide"==y.collapseType&&(b.Expand({type:"Expand",data:{}},u),b.Expand({type:"Expand",data:{}},l.location.origin)),b.FuguReady();break;case"IosFix":console.log("IosFix",e.data);var t=!!navigator.platform&&/iPhone|iPod/.test(navigator.platform),a=!!navigator.platform&&/iPad/.test(navigator.platform);t?e.data.data&&(void 0!==l.pageYOffset?l.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop):a&&(e.data.data?k():O());break;case"Image":s=e.data.data,console.log("image is clicked"),function(e){var t=document.createElement("div");t.id="imageContainer",t.onwheel=function(e){e.preventDefault(),e.stopPropagation()},t.ontouchmove=W;var a=document.createElement("button");a.id="closeimg",a.onclick=function(){document.body.removeChild(t)};var o=document.createTextNode("Close"),n=document.createElement("img");n.id="closeicon",n.src=f+"/public/img/close-btn.svg";var i=document.createElement("a");i.blank="target",i.target="_blank",i.id="downloadAnchor";var c=document.createTextNode("Download"),d=document.createElement("img");d.id="imageDownload",d.src=f+"/public/img/download.svg",i.appendChild(d),i.href=e;var s=document.createElement("div");s.id="imagediv";var l=document.createElement("img");l.id="WidgetImageMessage",l.src=e,s.appendChild(l),t.appendChild(s),a.appendChild(n),a.appendChild(o),i.appendChild(c),t.appendChild(a),t.appendChild(i),document.body.appendChild(t)}(s);break;case"UnreadCount":var o=new CustomEvent("UnreadCount",{detail:e.data.data});document.dispatchEvent(o);break;case"TotalUnreadCount":var n=new CustomEvent("TotalUnreadCount",{detail:e.data.data});document.dispatchEvent(n);break;case"AccessTokenEvent":var i=new CustomEvent("AccessTokenEvent",{detail:e.data.data});document.dispatchEvent(i);break;case"InitHippoConferenceComplete":"function"==typeof v&&(v.call(this,e.data.data),v="");break;case"HippoConferenceCallEvent":if(e.data&&e.data.data){var c=new CustomEvent("HippoConferenceEvent",{detail:e.data.data});document.dispatchEvent(c)}break;case"JoinHippoConferenceEvent":e.data&&e.data.data&&g&&g.location&&(g.location.href=e.data.data.href);break;case"CloseHippoConferenceEvent":e.data&&e.data.data&&e.data.data.close&&g&&g.close();break;case"group-call":e.data&&e.data.data&&b.GroupCall(e.data.data,u)}else if("CircularIframe"==e.data.message_sender)switch(console.log("circular iframe message",e),e.data.type){case"Collapse":b.Collapse(e.data,u),r&&r.classList.add("collapsed");try{p.classList.add("collapsed")}catch(e){console.log(e)}var d=new CustomEvent("hippoAgentWidgetCollapse",{});document.dispatchEvent(d);break;case"Expand":b.Expand(e.data,u),r&&r.classList.remove("collapsed","notification-1");try{p.classList.remove("collapsed","notification-1")}catch(e){console.log(e)}(t=!!navigator.platform&&/iPhone|iPod/.test(navigator.platform))&&L();break;case"ConfigCompleted":b.ConfigCompleted(e.data,u)}var s}},b={Initialize:function(e,t){x("Init",e,t)},Expand:function(e,t){x("Expand",e,t)},Collapse:function(e,t){x("Collapse",e,t);var a=new CustomEvent("HippoAgentWidgetCollapsed",{detail:{}});document.dispatchEvent(a)},Config:function(e,t){x("Config",e,l.location.origin)},Notification:function(e,t){x("Notification",e,l.location.origin)},Shutdown:function(e,t){x("Shutdown",e,t)},StartConversation:function(e,t){x("StartConversation",e,t)},InitHippoConference:function(e,t){x("InitHippoConference",e,t)},StartHippoConference:function(e,t){x("StartHippoConference",e,t)},CloseHippoConference:function(e,t){x("CloseHippoConference",e,t)},ConfigCompleted:function(e,t){x("ConfigCompleted",e,t)},ShowImage:function(e,t){x("ShowImage",e,t)},Blur:function(e,t){x("Blur",e,t)},FuguReady:function(){var e=new CustomEvent("fuguWidgetReady",{});document.dispatchEvent(e)},BotMessage:function(e,t){x("BotMessage",e,t)},OpenConversation:function(e,t){x("OpenConversation",e,t)},OpenMyConversation:function(e){x("OpenMyConversation",{},e)},NewCustomerOnline:function(e,t){x("NewCustomerOnline",t,e)},StartOneToOneChat:function(e,t){x("StartOneToOneChat",e,t)},StartOneToOneChatV2:function(e,t){x("StartOneToOneChatV2",e,t)},InitHippoLanguage:function(e,t){x("InitHippoLanguage",e,t)},OpenNotifications:function(e,t){x("OpenNotifications",e,t)},StartChatWithCustomer:function(e,t){x("StartChatWithCustomer",e,t)},GroupCall:function(e,t){x("group-call",e,t)}};function x(e,t,a){a==l.location.origin?p&&p.contentWindow.postMessage({type:e,data:t,parent_origin:l.location.origin,current_url:l.location.href,hostname:l.location.hostname},a):r&&r.contentWindow.postMessage({type:e,data:t,parent_origin:l.location.origin,current_url:l.location.href,hostname:l.location.hostname},a)}function w(){r&&r.remove(),p&&p.remove(),p=r=void 0}function L(){r.classList.add("ios-fix"),k()}function k(){try{p.classList.add("ipad-fix")}catch(e){console.log(e)}r.classList.add("ipad-fix");var e=document.createElement("div");e.id="ipadLayer",e.ontouchmove=I,e.onclick=T,e.ontouchstart=T,document.body.appendChild(e),document.getElementsByTagName("html")[0].classList.add("ipad-fix-html"),document.body.classList.add("ipad-fix-body")}function O(){try{p.classList.remove("ipad-fix")}catch(e){console.log(e)}r.classList.remove("ipad-fix");var e=document.getElementById("ipadLayer");document.body.removeChild(e),document.getElementsByTagName("html")[0].classList.remove("ipad-fix-html"),document.body.classList.remove("ipad-fix-body")}function W(e){e.preventDefault(),e.stopPropagation()}function T(e){document.activeElement.blur(),O(),b.Blur({type:"Blur",data:{}},u)}function I(e){W(e),document.activeElement.blur()}function S(){b.Expand({type:"Expand",data:{}},l.location.origin)}l.fuguInitAgent=o,l.fuguInitAgentWidget=i,l.fuguOpenConversation=function(e){r?e?b.OpenConversation(e,u):y.showConvData&&(b.OpenConversation(y.showConvData,u),y.showConvData=null):(i(y),y.showConvData=e,h=function(){l.fuguOpenConversation()})},l.fuguAgentMyConversation=function(){r?b.OpenMyConversation(u):(i(y),h=function(){l.fuguAgentMyConversation()})},l.fuguNewCustomerOnline=function(e){r?b.NewCustomerOnline(u,e):i(y)},l.fuguUpdateAgent=function(e){w(),o(e,!1)},l.shutDownFuguAgent=function(e){b.Shutdown({hostname:l.location.hostname,hideWidget:!!e&&e.hideWidget},u),localStorage.removeItem("f_uid_Id")},l.startConversationAgent=function(e){if(isComplete){r.classList.remove("collapsed","notification-1");try{p.classList.remove("collapsed","notification-1")}catch(e){console.log(e)}b.Expand({type:"Expand",data:{}},l.location.origin),b.StartConversation({data:e,origin:u},u)}},l.startOneToOneChat=function(e){if(isComplete){try{r.classList.remove("collapsed","notification-1"),p.classList.remove("collapsed","notification-1")}catch(e){console.log(e)}b.Expand({type:"Expand",data:{}},l.location.origin),b.StartOneToOneChat({data:e,origin:u},u)}},l.startChatWithCustomer=function(e){if(isComplete){try{r.classList.remove("collapsed","notification-1"),p.classList.remove("collapsed","notification-1")}catch(e){console.log(e)}b.Expand({type:"Expand",data:{}},l.location.origin),b.StartChatWithCustomer({data:e,origin:u},u)}},l.showConversationListAgent=S,l.fuguWidget_ExpandAgent=S,l.fuguWidget_CollapseAgent=function(){b.Collapse({type:"Collapse",data:{}},l.location.origin)},l.fuguWidget_BotMessageAgent=function(e){b.BotMessage(e,u)},l.fuguDestroyAgentWidget=w,l.initHippoLanguage=e,l.changeHippoLanguage=e,l.initHippoConference=function(e,t){"function"==typeof t&&(v=t),b.InitHippoConference({data:e,origin:u},u)},l.startHippoConference=function(e){g=l.open("","_blank","toolbar=no,scrollbars=yes,resizable=yes,location=no,top=100,left=250,width=800,height=600"),b.StartHippoConference({data:e,origin:u},u)},l.closeHippoConference=function(e){b.CloseHippoConference({data:e,origin:u},u)},l.startOneToOneChatV2=function(e){if(isComplete){try{r.classList.remove("collapsed","notification-1"),p.classList.remove("collapsed","notification-1")}catch(e){console.log(e)}b.Expand({type:"Expand",data:{}},l.location.origin),b.StartOneToOneChatV2({data:e,origin:u},u)}},l.openNotifications=function(e){if(isComplete){try{r.classList.remove("collapsed","notification-1"),p.classList.remove("collapsed","notification-1")}catch(e){console.log(e)}b.Expand({type:"Expand",data:{}},l.location.origin),b.OpenNotifications({data:e,origin:u},u)}},t=f+"/public/build/css/widget-agent.css",c="FuguAgentWidgetIframe_css",d=document.getElementsByTagName("head")[0],(s=document.createElement("link")).id=c,s.rel="stylesheet",s.type="text/css",s.href=t,s.media="all",d.appendChild(s)}(window);